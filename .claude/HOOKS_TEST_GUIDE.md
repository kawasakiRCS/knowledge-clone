# Claude Code Hooks テスト手順書

## 概要
Claude Code Hooksが正しく動作することを確認するためのテスト手順です。

## 事前準備
1. Claude Codeを再起動して、新しい設定を読み込ませる
2. プロジェクトディレクトリ（/home/ubuntu01/workspace/knowledge）で作業する

## テスト項目

### 1. TodoWrite完了チェックのテスト

**手順：**
1. Claude Codeで新しいタスクリストを作成
   ```
   TodoWriteツールを使って、以下のタスクを追加してください：
   - テストタスク1
   - Issue完了手続き実行
   - テストタスク3
   ```

2. 「Issue完了手続き実行」タスクを完了にする
   ```
   TodoWriteで「Issue完了手続き実行」のstatusをcompletedに変更してください
   ```

**期待される動作：**
- タスク完了後、以下のようなリマインダーが表示される：
  ```
  ⚠️  Issue完了手続きタスクが完了しました！
  📋 以下の手順を確実に実行してください：
  1. [ ] PROGRESS.mdの更新
  2. [ ] git add -A && git commit
  3. [ ] gh issue comment <Issue番号>
  4. [ ] gh issue close <Issue番号>
  ```

### 2. Git commit前チェックのテスト

**手順：**
1. 何かファイルを変更する（例：test.txtを作成）
   ```
   echo "test" > test.txt
   ```

2. git commitコマンドを実行しようとする
   ```
   git add test.txt
   git commit -m "test commit"
   ```

**期待される動作：**
- コミット実行前に以下のようなチェックリストが表示される：
  ```
  📝 コミット前チェックリスト
  ⚠️  PROGRESS.md の更新を確認してください！
  ```

### 3. セッション終了時チェックのテスト

**手順：**
1. ファイルを変更して、コミットしない状態にする
2. セッションを終了する（または新しいチャットを開始する）

**期待される動作：**
- セッション終了時に以下のような警告が表示される：
  ```
  🔍 セッション終了時チェック
  ⚠️  警告: コミットされていない変更があります！
  ```

## トラブルシューティング

### Hooksが動作しない場合
1. Claude Codeを完全に再起動する
2. 設定ファイルの構文を確認する：
   ```bash
   cat .claude/settings.json | jq .
   ```
3. スクリプトの実行権限を確認する：
   ```bash
   ls -la .claude/scripts/
   ```

### エラーが発生する場合
1. スクリプトを手動で実行してみる：
   ```bash
   .claude/scripts/check-session-end.sh
   ```
2. エラーメッセージを確認して修正する

## 注意事項
- Hooksは開発環境によって動作が異なる場合があります
- セキュリティのため、スクリプトには最小限の権限のみ付与してください
- チーム内で設定を共有する前に、十分なテストを行ってください

## フィードバック
問題や改善案がある場合は、以下の方法でフィードバックをお願いします：
1. GitHub Issueを作成
2. スクリプトを修正してPRを送信
3. CLAUDE.mdに改善案を追記